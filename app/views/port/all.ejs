<div class="container w1002 tn_margin" id="qiye">
    <%- partial("layouts/info_nav", {current_url: "/port"}) %>
    <div class="col-lg-10 col-md-10 col-sm-10 youce">
        <div class="bg_pale_yellow">
            <div class="col-lg-12 col-md-12 col-sm-12 pad_topbot_change">
                <h4 class="lh h4_line">
                    <div class="w120 pull-left ts_padding">港口信息</div>
                    <div class="third_nav third_hover"><a href="/port/all">所有信息</a></div>
                    <div class="third_nav"><a href="/port">我的信息</a></div>
                    <a href="/port/add" class="btn pull-right btn-info btn-sm">发布港口</a>
                </h4>
            </div>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12">
            <div class="line_search">
                <form class="navbar-form navbar-left" role="search">
                    <div class="w260 pull-left">
                        <div class="w80 pull-left ts_padding">港口类型：</div>
                        <div class="w180 pull-left">
                            <select id="portType" class="form-control min_hundred w160 input-sm">
                                <option>选择港口类型</option>
                                <%
                                if(locals.port_type){
                                        port_type.forEach(function(portType){
                                %>
                                <option value="<%= portType.id %>"><%= portType.name %></option>
                                <%
                                });
                                }
                                %>
                            </select>
                        </div>
                    </div>
                    <div class="w260 pull-left">
                        <div class="w80 pull-left ts_padding">港口级别：</div>
                        <div class="w180 pull-left">
                            <select id="portLevel" class="form-control min_hundred w160 input-sm">
                                <option>选择港口级别</option>
                                <%
                                if(locals.port_level){
                                        port_level.forEach(function(portLevel){
                                %>
                                <option value="<%= portLevel.id %>"><%= portLevel.name %></option>
                                <%
                                });
                                }
                                %>
                            </select>
                        </div>
                    </div>
                    <div class="pull-left w100"><input type="button" value="搜索" class="btn btn-success btn-sm"
                                                       onclick="search()"/></div>
                </form>
                <div class="clearfix"></div>
            </div>
        </div>
        <script type="text/javascript">
            $(function () {
                $('.info .info_item').hover(function () {
                    $('.info .info_item').removeClass('info_item_hover');
                    $(this).addClass('info_item_hover');
                });
            });
        </script>
        <div class="col-lg-12 col-dm-12 col-sm-12 info tn_margin">
            <% if(locals.ports && locals.ports.length){
            %>
            <%- partial('port/all_list', {
                ports: ports,
                current_page: current_page,
                list_count: list_count,
                pages: pages,
                base: base
            }) %>
            <% }else{ %>
            <div class="info_item">
                <div class="col-lg-12 tl_padding bl_padding text-danger text-center">对不起，没有找到适合您的信息
                </div>
            </div>
            <% } %>
        </div>
    </div>
</div>

<script src="/js/jquery.provincesCity.js" type="text/javascript"></script>
<script src="/js/core/city.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        var portType = '<%=portTypeCode%>';
        var portLevel = '<%=portLevelCode%>';

        if (portType && portType != 'undefined')
            $("#portType").val(portType).change();
        if (portLevel && portLevel != 'undefined')
            $("#portLevel").val(portLevel).change();
    });
    function search() {
        var url = "";
        var portType = $("#portType").val();
        var portLevel = $("#portLevel").val();

        if (portType && portType != "选择港口类型") {
            url += "portType=" + portType;
        }
        if (portLevel && portLevel != "选择港口级别") {
            url += "&portLevel=" + portLevel;
        }
        if (url) {
            if (url.substr(0, 1) == "&")
                url = url.substr(1, url.length - 1);
            window.location.href = "/port?" + url;
        }
        else {
            window.location.href = "/port";
        }
    }
</script>